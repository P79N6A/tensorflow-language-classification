# malware_api.py
# Copyright 2004-present Facebook. All Rights Reserved.

md5s = ['681f1b31baa671a81e4b803dbf8a9f10']

import json
from urllib import urlencode
from urllib2 import urlopen
from urlparse import urlunparse

fb_app_id = '<your-app-id>'
access_token = '<your-access-token>'

for md5 in md5s:
    query = urlencode({
        'access_token': access_token,
        'query_type': 'HASH',
        'hash_type': 'MD5',
        'hash_value': md5
    })
    url = urlunparse(('https', 'graph.facebook.com', '/' + fb_app_id + '/malware_analyses', '', query, ''))
    resp = urlopen(url).read()
    print json.loads(resp)
